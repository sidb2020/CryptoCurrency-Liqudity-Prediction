# -*- coding: utf-8 -*-
"""Data Preparation ML Project Sid.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1upjA-7BrBhrT1S0EBv3dCU8QbJR05JsK
"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd

file_16 = "/content/drive/MyDrive/PW Assignments/coin_gecko_2022-03-16.csv"
file_17 = "/content/drive/MyDrive/PW Assignments/coin_gecko_2022-03-17.csv"

df1 = pd.read_csv(file_16)
df2 = pd.read_csv(file_17)

df1["date"] = "2022-03-16"
df2["date"] = "2022-03-17"

df = pd.concat([df1, df2], ignore_index=True)

columns_to_drop = ['id', 'symbol', 'name', 'image', 'roi', 'atl', 'last_updated']
df = df.drop(columns=[col for col in columns_to_drop if col in df.columns], errors='ignore')

df = df.dropna().reset_index(drop=True)

# Save cleaned file back to Drive
output_path = "/content/drive/MyDrive/PW Assignments/merged_cleaned_crypto_data.csv"
df.to_csv(output_path, index=False)

print("Data cleaned and saved to:", output_path)
print("Final shape:", df.shape)